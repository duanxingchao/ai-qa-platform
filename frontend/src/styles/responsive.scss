// 响应式设计工具类和混合器

// 断点定义
$breakpoints: (
  'mobile': 480px,
  'tablet': 768px,
  'laptop': 1024px,
  'desktop': 1366px,
  'large': 1920px,
  'xlarge': 2560px
);

// 媒体查询混合器
@mixin respond-to($breakpoint) {
  @if map-has-key($breakpoints, $breakpoint) {
    @media (max-width: map-get($breakpoints, $breakpoint)) {
      @content;
    }
  } @else {
    @warn "Unknown breakpoint: #{$breakpoint}";
  }
}

@mixin respond-above($breakpoint) {
  @if map-has-key($breakpoints, $breakpoint) {
    @media (min-width: map-get($breakpoints, $breakpoint) + 1px) {
      @content;
    }
  } @else {
    @warn "Unknown breakpoint: #{$breakpoint}";
  }
}

@mixin respond-between($min, $max) {
  @if map-has-key($breakpoints, $min) and map-has-key($breakpoints, $max) {
    @media (min-width: map-get($breakpoints, $min) + 1px) and (max-width: map-get($breakpoints, $max)) {
      @content;
    }
  } @else {
    @warn "Unknown breakpoints: #{$min} or #{$max}";
  }
}

// 响应式字体大小混合器
@mixin responsive-font($min-size, $max-size, $min-vw: 320px, $max-vw: 1920px) {
  font-size: clamp(#{$min-size}, #{$min-size} + (#{strip-unit($max-size)} - #{strip-unit($min-size)}) * ((100vw - #{$min-vw}) / (#{strip-unit($max-vw)} - #{strip-unit($min-vw)})), #{$max-size});
}

// 移除单位的函数
@function strip-unit($number) {
  @if type-of($number) == 'number' and not unitless($number) {
    @return $number / ($number * 0 + 1);
  }
  @return $number;
}

// 响应式间距混合器
@mixin responsive-spacing($property, $min-size, $max-size) {
  #{$property}: clamp(#{$min-size}, #{$min-size} + (#{strip-unit($max-size)} - #{strip-unit($min-size)}) * ((100vw - 320px) / (1920 - 320)), #{$max-size});
}

// 网格布局响应式混合器
@mixin responsive-grid($min-width: 300px, $gap: 20px) {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(#{$min-width}, 1fr));
  gap: #{$gap};
  
  @include respond-to('tablet') {
    grid-template-columns: 1fr;
    gap: #{$gap * 0.75};
  }
}

// Flexbox响应式混合器
@mixin responsive-flex($direction: row, $wrap: wrap) {
  display: flex;
  flex-direction: #{$direction};
  flex-wrap: #{$wrap};
  
  @include respond-to('tablet') {
    flex-direction: column;
  }
}

// 响应式容器混合器
@mixin responsive-container($max-width: 1200px) {
  max-width: #{$max-width};
  margin: 0 auto;
  padding: 0 clamp(15px, 4vw, 40px);
  
  @include respond-to('tablet') {
    padding: 0 15px;
  }
}

// 工具类
.responsive-text {
  @include responsive-font(14px, 18px);
}

.responsive-title {
  @include responsive-font(24px, 48px);
}

.responsive-subtitle {
  @include responsive-font(18px, 24px);
}

.responsive-grid {
  @include responsive-grid();
}

.responsive-flex {
  @include responsive-flex();
}

.responsive-container {
  @include responsive-container();
}

// 显示/隐藏工具类
.hide-mobile {
  @include respond-to('tablet') {
    display: none !important;
  }
}

.hide-desktop {
  @include respond-above('tablet') {
    display: none !important;
  }
}

.show-mobile {
  display: none !important;
  
  @include respond-to('tablet') {
    display: block !important;
  }
}

.show-desktop {
  display: block !important;
  
  @include respond-to('tablet') {
    display: none !important;
  }
}

// 响应式图片
.responsive-img {
  max-width: 100%;
  height: auto;
  display: block;
}

// 响应式视频
.responsive-video {
  position: relative;
  padding-bottom: 56.25%; // 16:9 aspect ratio
  height: 0;
  overflow: hidden;
  
  iframe, video {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }
}

// 响应式表格
.responsive-table {
  overflow-x: auto;
  
  table {
    min-width: 600px;
    width: 100%;
  }
  
  @include respond-to('tablet') {
    table {
      min-width: 100%;
      font-size: 14px;
    }
  }
}

// 大屏专用样式
.bigscreen-responsive {
  // 超大屏幕优化
  @include respond-above('xlarge') {
    font-size: 120%;
    
    .card-title {
      font-size: 24px;
    }
    
    .metric-value {
      font-size: 32px;
    }
  }
  
  // 大屏幕
  @include respond-between('large', 'xlarge') {
    font-size: 110%;
  }
  
  // 中等屏幕
  @include respond-between('desktop', 'large') {
    font-size: 100%;
  }
  
  // 小屏幕适配
  @include respond-to('desktop') {
    font-size: 90%;
    
    .display-main {
      grid-template-columns: 1fr !important;
      gap: 15px;
    }
    
    .metrics-bar {
      flex-direction: column;
      gap: 15px;
      
      .metric-item {
        justify-content: flex-start;
        min-width: auto;
      }
    }
  }
  
  // 平板适配
  @include respond-to('laptop') {
    .display-header {
      flex-direction: column;
      height: auto;
      padding: 15px;
      gap: 10px;
      
      .header-left,
      .header-center,
      .header-right {
        flex: none;
        width: 100%;
        justify-content: center;
      }
    }
    
    .metrics-bar {
      margin: 15px;
      padding: 15px;
    }
    
    .display-main {
      padding: 15px;
      height: auto;
    }
  }
}
