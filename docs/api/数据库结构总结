

## 📊 数据库结构完整分析

### 🗄️ **核心业务表结构**

#### 1. **table1** (原始回流数据表) - 200条记录
- **用途**: 存储从yoyo系统回流的原始问答数据
- **关键字段**:
  - `id` - 主键
  - `query` - 用户问题文本
  - `answer` - 原始AI回答
  - `sendmessagetime` - 消息发送时间 (用于增量同步)
  - `classification` - 原始分类信息
  - `pageid`, `devicetypename`, `serviceid` - 业务元数据

#### 2. **questions** (问题表) - 285条记录
- **用途**: 经过清洗的问题数据，支持状态管理
- **关键字段**:
  - `id` - 主键
  - `business_id` - 业务唯一ID (与其他表关联)
  - `query` - 问题内容
  - `classification` - AI分类结果 (16个领域)
  - `processing_status` - 处理状态 (pending→classified→generated→scored)
  - `sendmessagetime` - 原始时间 (用于趋势分析)

#### 3. **answers** (答案表) - 265条记录
- **用途**: 存储多AI模型的答案数据
- **关键字段**:
  - `id` - 主键
  - `question_business_id` - 关联问题 (外键→questions.business_id)
  - `answer_text` - AI生成的答案内容
  - `assistant_type` - AI类型: `our_ai`, `doubao`, `xiaotian`
  - `is_scored` - 是否已评分标记

#### 4. **scores** (评分表) - 0条记录 ✨**已升级**
- **用途**: 存储五维评分数据，支持动态维度名称
- **核心字段**:
  - `answer_id` - 关联答案 (外键→answers.id)
  - `score_1~5` - 五个维度的评分 (1-5分)
  - **🆕 `dimension_1_name~5_name`** - 动态维度名称存储
  - `average_score` - 综合评分
  - `comment` - 评分理由

#### 5. **review_status** (审核状态表) - 0条记录
- **用途**: 人工审核管理
- **关键字段**:
  - `question_business_id` - 关联问题 (外键→questions.business_id)
  - `is_reviewed` - 审核状态
  - `reviewer_id` - 审核人员ID

### 🔗 **表关联关系**

```
table1 (原始数据: 200条)
    ↓ 数据同步清洗
questions (问题: 285条)
    ├── 1:N → answers (答案: 265条)
    │         ├── our_ai: 原始AI答案
    │         ├── doubao: 豆包AI答案  
    │         └── xiaotian: 小天AI答案
    │              ↓ 1:N
    │         scores (评分: 0条) ✨支持动态维度
    │         ├── dimension_1_name: "信息准确性"
    │         ├── dimension_2_name: "逻辑性"
    │         └── ...
    └── 1:1 → review_status (审核: 0条)
```

### 🎯 **数据处理流程状态**

1. **数据同步**: `table1(200)` → `questions(285)` ✅ 已完成
2. **答案生成**: `questions` → `answers(265)` ✅ 已完成  
3. **分类处理**: 部分问题已分类 🔄 进行中
4. **评分处理**: `answers` → `scores(0)` ⏳ 待开始
5. **审核流程**: `questions` → `review_status(0)` ⏳ 待开始

### 🔑 **核心改进点**

#### ✅ **动态评分维度支持**
- scores表新增5个 `dimension_X_name` 字段
- 支持16个领域的不同评分标准
- 如: "信息准确性"、"逻辑性"、"流畅性"、"创新性"等

#### ✅ **外键关系完整**
- `answers.question_business_id` → `questions.business_id`
- `scores.answer_id` → `answers.id`  
- `review_status.question_business_id` → `questions.business_id`

### 📈 **数据质量分析**

- **同步效率**: table1(200) → questions(285) = 142.5% (包含历史数据)
- **答案生成率**: 265/285 = 93% (豆包+小天+原始AI)
- **评分完成率**: 0/265 = 0% (需要启动评分流程)
- **数据完整性**: 外键关系正常，无孤立数据

现在您的数据库结构完全支持您的需求，特别是**动态评分维度**已经成功实现，可以处理16个不同领域的评分标准！