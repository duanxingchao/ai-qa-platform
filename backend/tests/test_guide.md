# AIé—®ç­”å¹³å°æµ‹è¯•æŒ‡å—

## ğŸ“‹ æµ‹è¯•æ¶æ„æ¦‚è§ˆ

ç»è¿‡é‡æ„æ•´ç†ï¼Œæµ‹è¯•ä½“ç³»ç°åœ¨æ›´åŠ ç®€æ´é«˜æ•ˆï¼š

### ğŸ—ï¸ æ ¸å¿ƒæµ‹è¯•æ–‡ä»¶
1. **`test_core.py`** - æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•ï¼ˆæ•°æ®åº“ã€åŒæ­¥ã€å•å…ƒæµ‹è¯•ï¼‰
2. **`test_api.py`** - APIæ¥å£æµ‹è¯•ï¼ˆREST APIã€å®¢æˆ·ç«¯ã€æµç¨‹æµ‹è¯•ï¼‰
3. **`run_tests.py`** - ç»Ÿä¸€æµ‹è¯•è¿è¡Œå™¨
4. **`mock_data_manager.py`** - Mockæ•°æ®ç®¡ç†å·¥å…·

### ğŸ—‘ï¸ å·²æ¸…ç†çš„æ–‡ä»¶
- `test_unit.py` â†’ åˆå¹¶åˆ° `test_core.py`
- `test_database.py` â†’ åˆå¹¶åˆ° `test_core.py`
- `test_new_sync.py` â†’ åˆå¹¶åˆ° `test_core.py`
- `test_api_simplified.py` â†’ åˆå¹¶åˆ° `test_api.py`
- `test_api_flow.py` â†’ åˆå¹¶åˆ° `test_api.py`
- `test_api_client.py` â†’ åˆå¹¶åˆ° `test_api.py`
- `comprehensive_test.py` â†’ åŠŸèƒ½åˆ†æ•£åˆ°æ ¸å¿ƒæµ‹è¯•ä¸­
- `test_simple_sync.py` â†’ åˆå¹¶åˆ°æ ¸å¿ƒæµ‹è¯•ä¸­

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡
```bash
cd backend
source venv/bin/activate
cd tests
```

### 2. è¿è¡Œæ‰€æœ‰æµ‹è¯•
```bash
python run_tests.py
```

### 3. è¿è¡Œç‰¹å®šç±»å‹æµ‹è¯•
```bash
# åªè¿è¡Œæ ¸å¿ƒåŠŸèƒ½æµ‹è¯•
python run_tests.py --type core

# åªè¿è¡ŒAPIæµ‹è¯•
python run_tests.py --type api
```

### 4. ç›´æ¥è¿è¡Œå•ä¸ªæµ‹è¯•æ–‡ä»¶
```bash
# æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•
python test_core.py

# APIæµ‹è¯•
python test_api.py
```

## ğŸ“Š æµ‹è¯•å†…å®¹è¯¦è§£

### ğŸ§ª æ ¸å¿ƒåŠŸèƒ½æµ‹è¯• (`test_core.py`)

#### æ•°æ®åº“æµ‹è¯•
- âœ… æ•°æ®åº“è¿æ¥æµ‹è¯•
- âœ… å¿…éœ€è¡¨å­˜åœ¨æ€§æ£€æŸ¥ï¼ˆtable1, questions, answers, scores, review_statusï¼‰
- âœ… table1è¡¨ç»“æ„å’Œæ•°æ®è´¨é‡éªŒè¯
- âœ… å­—æ®µå®Œæ•´æ€§æ£€æŸ¥

#### åŒæ­¥æœåŠ¡æµ‹è¯•
- âœ… è·å–åŒæ­¥çŠ¶æ€
- âœ… è·å–åŒæ­¥ç»Ÿè®¡ä¿¡æ¯
- âœ… æ‰§è¡Œæ•°æ®åŒæ­¥æ“ä½œ
- âœ… éªŒè¯åŒè¡¨åŒæ­¥é€»è¾‘ï¼ˆquestions + answersï¼‰

#### æ•°æ®ä¸€è‡´æ€§æµ‹è¯•
- âœ… business_idç”Ÿæˆé€»è¾‘éªŒè¯
- âœ… SQLè¿‡æ»¤é€»è¾‘æµ‹è¯•
- âœ… æ•°æ®å®Œæ•´æ€§æ£€æŸ¥

#### æ•°æ®æ¨¡å‹æµ‹è¯•
- âœ… Questionæ¨¡å‹åŸºç¡€æ“ä½œ
- âœ… Answeræ¨¡å‹åŸºç¡€æ“ä½œ
- âœ… ORMé›†æˆæµ‹è¯•

### ğŸŒ APIæµ‹è¯• (`test_api.py`)

#### åŒæ­¥APIæµ‹è¯•
- âœ… GET `/api/sync/status` - åŒæ­¥çŠ¶æ€
- âœ… GET `/api/sync/statistics` - ç»Ÿè®¡ä¿¡æ¯
- âœ… POST `/api/sync/trigger` - è§¦å‘åŒæ­¥
- âœ… GET `/api/sync/health` - å¥åº·æ£€æŸ¥
- âœ… GET `/api/sync/data` - æ•°æ®åˆ†é¡µæŸ¥çœ‹

#### APIå®¢æˆ·ç«¯æµ‹è¯•
- âœ… APIå®¢æˆ·ç«¯å·¥å‚æ¨¡å¼
- âœ… å•ä¾‹æ¨¡å¼éªŒè¯
- âœ… ç»Ÿè®¡ä¿¡æ¯æ”¶é›†
- âœ… Mock APIè°ƒç”¨æµ‹è¯•

#### APIæµç¨‹æµ‹è¯•
- âœ… æ•°æ®åº“åˆ°APIçš„å®Œæ•´æµç¨‹
- âœ… é—®é¢˜åˆ†ç±»æµç¨‹æµ‹è¯•
- âœ… æ€§èƒ½å’Œé”™è¯¯å¤„ç†æµ‹è¯•

## ğŸ“ æµ‹è¯•ç»“æœè§£è¯»

### æˆåŠŸè¾“å‡ºç¤ºä¾‹
```
ğŸ§ª æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•
============================================================
âœ… æ•°æ®åº“è¿æ¥æˆåŠŸ: PostgreSQL 13.x...
âœ… table1: å­˜åœ¨ (60 æ¡è®°å½•)
âœ… questions: å­˜åœ¨ (30 æ¡è®°å½•)
âœ… answers: å­˜åœ¨ (30 æ¡è®°å½•)
âœ… table1æ•°æ®è´¨é‡: 100.0% (60/60)
âœ… åŒæ­¥çŠ¶æ€: {'status': 'idle', 'total_synced': 30}
âœ… business_idç”Ÿæˆé€»è¾‘æ­£ç¡®
âœ… Questionæ¨¡å‹æŸ¥è¯¢æˆåŠŸ: 30 æ¡è®°å½•
âœ… Answeræ¨¡å‹æŸ¥è¯¢æˆåŠŸ: 30 æ¡è®°å½•

ğŸ“ˆ æˆåŠŸç‡: 100.0%
ğŸ‰ æ‰€æœ‰æ ¸å¿ƒæµ‹è¯•é€šè¿‡!
```

### å¸¸è§é”™è¯¯å¤„ç†

#### æ•°æ®åº“è¿æ¥é—®é¢˜
```
âŒ æ•°æ®åº“è¿æ¥å¤±è´¥: could not connect to server
```
**è§£å†³æ–¹æ¡ˆ**: æ£€æŸ¥æ•°æ®åº“æœåŠ¡çŠ¶æ€å’Œè¿æ¥é…ç½®

#### FlaskæœåŠ¡å™¨æœªå¯åŠ¨
```
âš ï¸ æ‰€æœ‰APIæµ‹è¯•éƒ½è¢«è·³è¿‡äº†ï¼Œè¯·æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€
ğŸ’¡ æç¤º: FlaskæœåŠ¡å™¨æœªå¯åŠ¨ï¼Œè¯·è¿è¡Œ 'python run.py' å¯åŠ¨æœåŠ¡å™¨
```
**è§£å†³æ–¹æ¡ˆ**: å¯åŠ¨Flaskåº”ç”¨

#### Mock APIæœåŠ¡å™¨é—®é¢˜
```
âš ï¸ Mock APIæœåŠ¡å™¨æœªå¯åŠ¨
ğŸ’¡ æç¤º: Mock APIæœåŠ¡å™¨æœªå¯åŠ¨ï¼Œè¯·è¿è¡Œ 'python mock_classification_api.py' å¯åŠ¨MockæœåŠ¡
```
**è§£å†³æ–¹æ¡ˆ**: å¯åŠ¨Mock APIæœåŠ¡å™¨

## ğŸ› ï¸ Mockæ•°æ®ç®¡ç†

### æŸ¥çœ‹æ•°æ®çŠ¶æ€
```bash
python mock_data_manager.py --action stats
```

### æ·»åŠ æµ‹è¯•æ•°æ®
```bash
# æ·»åŠ 30æ¡æ•°æ®
python mock_data_manager.py --action add_data --count 30

# ä¸ºç°æœ‰æ•°æ®è¡¥é½answerå­—æ®µ
python mock_data_manager.py --action update_answers
```

### å®Œæ•´è®¾ç½®
```bash
# ä¸€é”®å®Œæˆè¡¨åˆ›å»ºã€æ•°æ®ç”Ÿæˆã€å­—æ®µè¡¥é½
python mock_data_manager.py --action full_setup --count 50
```

## ğŸ”§ é«˜çº§æµ‹è¯•é€‰é¡¹

### æµ‹è¯•ç‰¹å®šåŠŸèƒ½
```bash
# åªæµ‹è¯•æ•°æ®åº“è¿æ¥
python -c "from test_core import DatabaseTests; import unittest; unittest.main(module=None, argv=[''], testLoader=unittest.TestLoader().loadTestsFromTestCase(DatabaseTests), exit=False)"

# åªæµ‹è¯•åŒæ­¥æœåŠ¡
python -c "from test_core import SyncServiceTests; import unittest; unittest.main(module=None, argv=[''], testLoader=unittest.TestLoader().loadTestsFromTestCase(SyncServiceTests), exit=False)"
```

### è¯¦ç»†è¾“å‡º
```bash
python run_tests.py --verbose
```

## ğŸ“ˆ æŒç»­é›†æˆå»ºè®®

### æ¨èçš„æµ‹è¯•æµç¨‹
1. **å¼€å‘é˜¶æ®µ**: è¿è¡Œ `python test_core.py`
2. **åŠŸèƒ½æµ‹è¯•**: è¿è¡Œ `python test_api.py`
3. **å®Œæ•´æµ‹è¯•**: è¿è¡Œ `python run_tests.py`
4. **éƒ¨ç½²å‰**: è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶å¹¶ç¡®ä¿100%é€šè¿‡

### æµ‹è¯•è¦†ç›–ç‡ç›®æ ‡
- ğŸ¯ æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•: 100% é€šè¿‡
- ğŸ¯ APIæµ‹è¯•: 90%+ é€šè¿‡ï¼ˆå…è®¸éƒ¨åˆ†è·³è¿‡ï¼‰
- ğŸ¯ æ•´ä½“æˆåŠŸç‡: 95%+

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

#### 1. å¯¼å…¥é”™è¯¯
```bash
ModuleNotFoundError: No module named 'app'
```
**è§£å†³**: ç¡®ä¿åœ¨backendç›®å½•ä¸‹è¿è¡Œï¼Œå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ

#### 2. æ•°æ®åº“è¡¨ä¸å­˜åœ¨
```bash
relation "questions" does not exist
```
**è§£å†³**: è¿è¡Œæ•°æ®åº“è¿ç§»æˆ–é‡æ–°åˆ›å»ºè¡¨ç»“æ„

#### 3. æµ‹è¯•æ•°æ®ä¸è¶³
```bash
æ²¡æœ‰æœ‰æ•ˆçš„queryæ•°æ®
```
**è§£å†³**: ä½¿ç”¨mock_data_manager.pyæ·»åŠ æµ‹è¯•æ•°æ®

#### 4. ç½‘ç»œè¶…æ—¶
```bash
requests.exceptions.Timeout
```
**è§£å†³**: æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œå¢åŠ è¶…æ—¶æ—¶é—´

## ğŸ“š æ‰©å±•å¼€å‘

### æ·»åŠ æ–°æµ‹è¯•
1. åœ¨`test_core.py`ä¸­æ·»åŠ æ–°çš„æµ‹è¯•ç±»
2. åœ¨`test_api.py`ä¸­æ·»åŠ æ–°çš„APIæµ‹è¯•
3. æ›´æ–°æµ‹è¯•æŒ‡å—æ–‡æ¡£

### æµ‹è¯•æœ€ä½³å®è·µ
- âœ… ä½¿ç”¨æè¿°æ€§çš„æµ‹è¯•æ–¹æ³•å
- âœ… æ¯ä¸ªæµ‹è¯•åªéªŒè¯ä¸€ä¸ªåŠŸèƒ½ç‚¹
- âœ… æä¾›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯
- âœ… é€‚å½“ä½¿ç”¨setUpå’ŒtearDown
- âœ… æµ‹è¯•è¾¹ç•Œæ¡ä»¶å’Œé”™è¯¯æƒ…å†µ

---

**ğŸ¯ ç›®æ ‡**: é€šè¿‡ç®€åŒ–çš„æµ‹è¯•æ¶æ„ï¼Œæé«˜æµ‹è¯•æ•ˆç‡ï¼Œé™ä½ç»´æŠ¤æˆæœ¬ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§ã€‚ 