# ğŸŒ å†…ç½‘ä»£ç†ç¯å¢ƒéƒ¨ç½²æŒ‡å—

## ğŸ“‹ **éƒ¨ç½²å‰å‡†å¤‡**

### **å¿…éœ€ä¿¡æ¯æ¸…å•**
```bash
# 1. ä»£ç†æœåŠ¡å™¨ä¿¡æ¯
ä»£ç†æœåŠ¡å™¨åœ°å€: http://proxy-server:port
ä»£ç†ç”¨æˆ·å: _________________ (å¦‚æœéœ€è¦è®¤è¯)
ä»£ç†å¯†ç : ___________________ (å¦‚æœéœ€è¦è®¤è¯)

# 2. æœåŠ¡å™¨ä¿¡æ¯
æœåŠ¡å™¨IP: ___________________
SSHç”¨æˆ·å: _________________
SSHå¯†ç /å¯†é’¥: ______________

# 3. é«˜æ–¯æ•°æ®åº“ä¿¡æ¯
æ•°æ®åº“åœ°å€: ________________
æ•°æ®åº“ç«¯å£: 5432 (é»˜è®¤)
æ•°æ®åº“å: __________________
ç”¨æˆ·å: ____________________
å¯†ç : ______________________

# 4. å¤–éƒ¨APIä¿¡æ¯ (å¯é€‰)
åˆ†ç±»APIåœ°å€: _______________
åˆ†ç±»APIå¯†é’¥: _______________
AIç”ŸæˆAPIåœ°å€: _____________
AIç”ŸæˆAPIå¯†é’¥: _____________
```

## ğŸš€ **å®Œæ•´éƒ¨ç½²æµç¨‹**

### **é˜¶æ®µä¸€ï¼šä»£ç†ç¯å¢ƒé…ç½® (15åˆ†é’Ÿ)**

#### **æ­¥éª¤1: è¿æ¥æœåŠ¡å™¨**
```bash
# 1.1 SSHè¿æ¥åˆ°å…¬å¸æœåŠ¡å™¨
ssh your-username@your-server-ip

# 1.2 ç¡®è®¤ç³»ç»Ÿç‰ˆæœ¬
cat /etc/os-release
# åº”è¯¥æ˜¾ç¤º Ubuntu 18.04
```

#### **æ­¥éª¤2: ä¸‹è½½é¡¹ç›®ä»£ç **
```bash
# 2.1 ä¸´æ—¶è®¾ç½®ä»£ç†ï¼ˆç”¨äºgit cloneï¼‰
export http_proxy=http://æ‚¨çš„ä»£ç†æœåŠ¡å™¨åœ°å€:ç«¯å£
export https_proxy=http://æ‚¨çš„ä»£ç†æœåŠ¡å™¨åœ°å€:ç«¯å£

# 2.2 é…ç½®Gitä»£ç†
git config --global http.proxy http://æ‚¨çš„ä»£ç†æœåŠ¡å™¨åœ°å€:ç«¯å£
git config --global https.proxy http://æ‚¨çš„ä»£ç†æœåŠ¡å™¨åœ°å€:ç«¯å£

# 2.3 å…‹éš†é¡¹ç›®
git clone https://github.com/duanxingchao/ai-qa-platform.git

# 2.4 è¿›å…¥é¡¹ç›®ç›®å½•
cd ai-qa-platform

# 2.5 ç¡®è®¤æ–‡ä»¶å­˜åœ¨
ls -la setup-proxy-environment.sh deploy-ubuntu18.sh
```

#### **æ­¥éª¤3: é…ç½®ä»£ç†ç¯å¢ƒ**
```bash
# 3.1 ç»™è„šæœ¬æ‰§è¡Œæƒé™
chmod +x setup-proxy-environment.sh

# 3.2 è¿è¡Œä»£ç†é…ç½®è„šæœ¬
./setup-proxy-environment.sh

# æŒ‰æç¤ºè¾“å…¥ï¼š
# - ä»£ç†æœåŠ¡å™¨åœ°å€: http://proxy-server:port
# - æ˜¯å¦éœ€è¦è®¤è¯: y/n
# - ç”¨æˆ·åå’Œå¯†ç ï¼ˆå¦‚æœéœ€è¦ï¼‰

# 3.3 é‡æ–°åŠ è½½ç¯å¢ƒå˜é‡
source ~/.bashrc

# 3.4 éªŒè¯ä»£ç†é…ç½®
echo $http_proxy
curl -I https://www.google.com
```

### **é˜¶æ®µäºŒï¼šç³»ç»Ÿç¯å¢ƒå‡†å¤‡ (20åˆ†é’Ÿ)**

#### **æ­¥éª¤4: ç³»ç»Ÿå…¼å®¹æ€§æ£€æŸ¥**
```bash
# 4.1 ç»™è„šæœ¬æ‰§è¡Œæƒé™
chmod +x ubuntu18-compatibility-check.sh

# 4.2 è¿è¡Œå…¼å®¹æ€§æ£€æŸ¥
./ubuntu18-compatibility-check.sh

# 4.3 æŸ¥çœ‹æ£€æŸ¥ç»“æœ
# å¦‚æœçœ‹åˆ° "âœ… å…¼å®¹æ€§æ£€æŸ¥å®Œæˆï¼" è¯´æ˜ç³»ç»Ÿå…¼å®¹
```

#### **æ­¥éª¤5: å®‰è£…Dockerç¯å¢ƒï¼ˆæ”¯æŒä»£ç†ï¼‰**
```bash
# 5.1 è¿è¡Œå¢å¼ºçš„éƒ¨ç½²è„šæœ¬
chmod +x deploy-ubuntu18.sh
./deploy-ubuntu18.sh

# è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
# - æ£€æµ‹ä»£ç†é…ç½®
# - é…ç½®APTä»£ç†
# - é…ç½®Dockerä»£ç†
# - å®‰è£…Dockerå’ŒDocker Compose
# - é…ç½®Dockeré•œåƒæº

# 5.2 é‡æ–°åŠ è½½ç”¨æˆ·ç»„æƒé™
newgrp docker

# 5.3 éªŒè¯Dockerå®‰è£…
docker --version
docker-compose --version

# 5.4 æµ‹è¯•Dockeræƒé™
docker ps
```

### **é˜¶æ®µä¸‰ï¼šé¡¹ç›®é…ç½® (15åˆ†é’Ÿ)**

#### **æ­¥éª¤6: é…ç½®ç¯å¢ƒå˜é‡**
```bash
# 6.1 å¤åˆ¶é…ç½®æ¨¡æ¿
cp .env.production .env

# 6.2 ç”Ÿæˆå®‰å…¨å¯†é’¥
SECRET_KEY=$(openssl rand -hex 32)
JWT_SECRET_KEY=$(openssl rand -hex 32)

# 6.3 ç¼–è¾‘é…ç½®æ–‡ä»¶
nano .env

# åœ¨nanoç¼–è¾‘å™¨ä¸­ä¿®æ”¹ä»¥ä¸‹å†…å®¹ï¼š
```

**ç¯å¢ƒå˜é‡é…ç½®ç¤ºä¾‹ï¼š**
```bash
# æ•°æ®åº“è¿æ¥ (å¿…é¡»ä¿®æ”¹)
DATABASE_URL=postgresql://æ‚¨çš„ç”¨æˆ·å:æ‚¨çš„å¯†ç @æ‚¨çš„é«˜æ–¯æ•°æ®åº“åœ°å€:5432/æ‚¨çš„æ•°æ®åº“å

# å®‰å…¨å¯†é’¥ (å¿…é¡»ä¿®æ”¹)
SECRET_KEY=åˆšæ‰ç”Ÿæˆçš„SECRET_KEY
JWT_SECRET_KEY=åˆšæ‰ç”Ÿæˆçš„JWT_SECRET_KEY

# APIé…ç½® (å¦‚æœæœ‰çœŸå®API)
CLASSIFICATION_API_URL=æ‚¨çš„åˆ†ç±»APIåœ°å€
CLASSIFICATION_API_KEY=æ‚¨çš„åˆ†ç±»APIå¯†é’¥
AI_API_URL=æ‚¨çš„AIç”ŸæˆAPIåœ°å€
AI_API_KEY=æ‚¨çš„AIç”ŸæˆAPIå¯†é’¥

# ä»£ç†é…ç½® (å¦‚æœAPIéœ€è¦é€šè¿‡ä»£ç†è®¿é—®)
HTTP_PROXY=http://æ‚¨çš„ä»£ç†æœåŠ¡å™¨åœ°å€:ç«¯å£
HTTPS_PROXY=http://æ‚¨çš„ä»£ç†æœåŠ¡å™¨åœ°å€:ç«¯å£
```

#### **æ­¥éª¤7: æµ‹è¯•æ•°æ®åº“è¿æ¥**
```bash
# 7.1 æµ‹è¯•é«˜æ–¯æ•°æ®åº“è¿æ¥
docker run --rm \
  --env http_proxy="$http_proxy" \
  --env https_proxy="$https_proxy" \
  postgres:13 \
  psql "postgresql://æ‚¨çš„ç”¨æˆ·å:æ‚¨çš„å¯†ç @æ‚¨çš„é«˜æ–¯æ•°æ®åº“åœ°å€:5432/æ‚¨çš„æ•°æ®åº“å" \
  -c "SELECT version();"

# 7.2 å¦‚æœè¿æ¥æˆåŠŸï¼Œåº”è¯¥æ˜¾ç¤ºæ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯
```

### **é˜¶æ®µå››ï¼šæœåŠ¡éƒ¨ç½² (20åˆ†é’Ÿ)**

#### **æ­¥éª¤8: æ„å»ºå’Œå¯åŠ¨æœåŠ¡**
```bash
# 8.1 å¯åŠ¨éƒ¨ç½²ï¼ˆDockerä¼šè‡ªåŠ¨ä½¿ç”¨ä»£ç†é…ç½®ï¼‰
docker-compose -f docker-compose.ubuntu18.yml up -d --build

# 8.2 æŸ¥çœ‹éƒ¨ç½²è¿›åº¦
docker-compose -f docker-compose.ubuntu18.yml logs -f

# 8.3 ç­‰å¾…æ‰€æœ‰æœåŠ¡å¯åŠ¨
# çœ‹åˆ°ç±»ä¼¼ä¿¡æ¯è¯´æ˜å¯åŠ¨æˆåŠŸï¼š
# backend_1    | Starting QA Platform Backend...
# frontend_1   | Starting QA Platform Frontend...
# redis_1      | Ready to accept connections

# 8.4 æŒ‰ Ctrl+C é€€å‡ºæ—¥å¿—æŸ¥çœ‹
```

#### **æ­¥éª¤9: éªŒè¯éƒ¨ç½²æˆåŠŸ**
```bash
# 9.1 æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker-compose -f docker-compose.ubuntu18.yml ps

# åº”è¯¥çœ‹åˆ°æ‰€æœ‰å®¹å™¨çŠ¶æ€ä¸º "Up"

# 9.2 æµ‹è¯•åç«¯API
curl http://localhost:18088/api/health

# åº”è¯¥è¿”å›ï¼š{"status": "healthy"}

# 9.3 æµ‹è¯•å‰ç«¯æœåŠ¡
curl http://localhost:18080/health

# åº”è¯¥è¿”å›ï¼šhealthy

# 9.4 æµ‹è¯•æ•°æ®åº“è¿æ¥
docker-compose -f docker-compose.ubuntu18.yml exec backend python -c "
from app import create_app
from app.utils.database import db
app = create_app()
with app.app_context():
    result = db.engine.execute('SELECT 1').scalar()
    print(f'âœ… æ•°æ®åº“è¿æ¥æˆåŠŸï¼Œæµ‹è¯•æŸ¥è¯¢ç»“æœ: {result}')
"
```

#### **æ­¥éª¤10: åˆå§‹åŒ–æ•°æ®åº“**
```bash
# 10.1 åˆ›å»ºæ•°æ®åº“è¡¨
docker-compose -f docker-compose.ubuntu18.yml exec backend python -c "
from app import create_app
from app.utils.database import db
app = create_app()
with app.app_context():
    db.create_all()
    print('âœ… æ•°æ®åº“è¡¨åˆ›å»ºå®Œæˆ')
"

# 10.2 éªŒè¯è¡¨åˆ›å»º
docker-compose -f docker-compose.ubuntu18.yml exec backend python -c "
from app import create_app
from app.utils.database import db
app = create_app()
with app.app_context():
    tables = db.engine.table_names()
    print(f'âœ… åˆ›å»ºçš„è¡¨: {tables}')
"
```

#### **æ­¥éª¤11: è®¿é—®ç³»ç»Ÿ**
```bash
# 11.1 è·å–æœåŠ¡å™¨IP
hostname -I

# 11.2 åœ¨æµè§ˆå™¨ä¸­è®¿é—®
# å‰ç«¯é¡µé¢: http://æ‚¨çš„æœåŠ¡å™¨IP:18080
# åç«¯API: http://æ‚¨çš„æœåŠ¡å™¨IP:18088

# 11.3 ç™»å½•ç³»ç»Ÿ
# é»˜è®¤è´¦å·: admin
# é»˜è®¤å¯†ç : admin123
```

## ğŸ”§ **ä»£ç†ç¯å¢ƒç‰¹æ®Šé…ç½®**

### **Dockerä»£ç†é…ç½®éªŒè¯**
```bash
# æ£€æŸ¥Docker daemonä»£ç†é…ç½®
sudo cat /etc/docker/daemon.json

# æ£€æŸ¥DockeræœåŠ¡ä»£ç†é…ç½®
sudo cat /etc/systemd/system/docker.service.d/http-proxy.conf

# é‡å¯DockeræœåŠ¡ï¼ˆå¦‚æœéœ€è¦ï¼‰
sudo systemctl daemon-reload
sudo systemctl restart docker
```

### **å®¹å™¨å†…ä»£ç†é…ç½®**
å¦‚æœå®¹å™¨å†…çš„åº”ç”¨éœ€è¦è®¿é—®å¤–éƒ¨APIï¼Œç¡®ä¿åœ¨docker-compose.ubuntu18.ymlä¸­æ·»åŠ ä»£ç†ç¯å¢ƒå˜é‡ï¼š

```yaml
services:
  backend:
    environment:
      - HTTP_PROXY=${HTTP_PROXY}
      - HTTPS_PROXY=${HTTPS_PROXY}
      - NO_PROXY=localhost,127.0.0.1,::1
```

## ğŸš¨ **å¸¸è§é—®é¢˜è§£å†³**

### **é—®é¢˜1: ä»£ç†è¿æ¥å¤±è´¥**
```bash
# æ£€æŸ¥ä»£ç†é…ç½®
echo $http_proxy
echo $https_proxy

# æµ‹è¯•ä»£ç†è¿æ¥
curl -v --proxy "$http_proxy" https://www.google.com

# é‡æ–°é…ç½®ä»£ç†
./setup-proxy-environment.sh
```

### **é—®é¢˜2: Dockeré•œåƒä¸‹è½½å¤±è´¥**
```bash
# æ£€æŸ¥Dockerä»£ç†é…ç½®
sudo cat /etc/docker/daemon.json

# æ‰‹åŠ¨æ‹‰å–é•œåƒæµ‹è¯•
docker pull hello-world

# å¦‚æœå¤±è´¥ï¼Œé‡æ–°é…ç½®Dockerä»£ç†
sudo systemctl restart docker
```

### **é—®é¢˜3: npm/yarnå®‰è£…å¤±è´¥**
```bash
# æ£€æŸ¥npmä»£ç†é…ç½®
npm config get proxy
npm config get https-proxy

# é‡æ–°é…ç½®npmä»£ç†
npm config set proxy "$http_proxy"
npm config set https-proxy "$https_proxy"
npm config set registry https://registry.npmmirror.com/
```

## âœ… **éƒ¨ç½²æˆåŠŸç¡®è®¤**

å½“æ‚¨çœ‹åˆ°ä»¥ä¸‹æ‰€æœ‰ç»“æœæ—¶ï¼Œè¯´æ˜åœ¨ä»£ç†ç¯å¢ƒä¸‹éƒ¨ç½²å®Œå…¨æˆåŠŸï¼š

1. âœ… ä»£ç†è¿æ¥æµ‹è¯•é€šè¿‡
2. âœ… `docker-compose ps` æ˜¾ç¤ºæ‰€æœ‰å®¹å™¨ä¸º"Up"çŠ¶æ€
3. âœ… `curl http://localhost:18088/api/health` è¿”å›å¥åº·çŠ¶æ€
4. âœ… æµè§ˆå™¨å¯ä»¥è®¿é—® `http://æ‚¨çš„æœåŠ¡å™¨IP:18080`
5. âœ… å¯ä»¥ä½¿ç”¨admin/admin123ç™»å½•ç³»ç»Ÿ
6. âœ… æ•°æ®åº“è¿æ¥æµ‹è¯•é€šè¿‡

**æ­å–œï¼æ‚¨çš„æ™ºèƒ½é—®ç­”ç³»ç»Ÿå·²åœ¨ä»£ç†ç¯å¢ƒä¸‹æˆåŠŸéƒ¨ç½²ï¼** ğŸ‰
