<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIåˆ†ç±»è¯„åˆ†æµ‹è¯•</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #1a1a1a;
            color: white;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .chart-container {
            width: 100%;
            height: 600px;
            background-color: #2a2a2a;
            border-radius: 8px;
            padding: 20px;
            box-sizing: border-box;
        }
        .title {
            text-align: center;
            margin-bottom: 20px;
            color: #00d4ff;
        }
        .api-test {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #333;
            border-radius: 5px;
        }
        .api-result {
            background-color: #444;
            padding: 10px;
            border-radius: 3px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">ğŸ¤– AIåˆ†ç±»è¯„åˆ†å¯¹æ¯”æµ‹è¯•</h1>
        
        <div class="api-test">
            <h3>APIæµ‹è¯•ç»“æœï¼š</h3>
            <div id="apiResult" class="api-result">æ­£åœ¨åŠ è½½...</div>
        </div>
        
        <div class="chart-container">
            <div id="aiChart" style="width: 100%; height: 100%;"></div>
        </div>
    </div>

    <script>
        // æµ‹è¯•API
        async function testAPI() {
            try {
                const response = await fetch('/api/display/ai-category-scores');
                const data = await response.json();
                
                document.getElementById('apiResult').innerHTML = JSON.stringify(data, null, 2);
                
                if (data.success && data.data) {
                    createChart(data.data.chart_data);
                }
            } catch (error) {
                document.getElementById('apiResult').innerHTML = 'é”™è¯¯: ' + error.message;
                // ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
                createMockChart();
            }
        }

        // åˆ›å»ºå›¾è¡¨
        function createChart(chartData) {
            const chart = echarts.init(document.getElementById('aiChart'));
            
            // åˆ†ä¸¤æ’æ˜¾ç¤ºï¼Œæ¯æ’8ä¸ªåˆ†ç±»
            const firstRowData = chartData.slice(0, 8);
            const secondRowData = chartData.slice(8, 16);
            
            const option = {
                backgroundColor: 'transparent',
                title: {
                    text: 'AIåˆ†ç±»è¯„åˆ†å¯¹æ¯”',
                    left: 'center',
                    textStyle: {
                        color: '#ffffff',
                        fontSize: 18
                    }
                },
                grid: [
                    {
                        left: '5%',
                        right: '5%',
                        top: '15%',
                        height: '35%',
                        containLabel: true
                    },
                    {
                        left: '5%',
                        right: '5%',
                        top: '60%',
                        height: '35%',
                        containLabel: true
                    }
                ],
                legend: {
                    data: ['YOYO', 'è±†åŒ…', 'å°å¤©'],
                    top: '8%',
                    textStyle: {
                        color: '#ffffff',
                        fontSize: 14
                    },
                    itemWidth: 20,
                    itemHeight: 12
                },
                xAxis: [
                    {
                        type: 'category',
                        data: firstRowData.map(item => item.category),
                        gridIndex: 0,
                        axisLabel: {
                            color: '#ffffff',
                            fontSize: 12,
                            rotate: 45
                        },
                        axisLine: {
                            lineStyle: { color: '#444' }
                        }
                    },
                    {
                        type: 'category',
                        data: secondRowData.map(item => item.category),
                        gridIndex: 1,
                        axisLabel: {
                            color: '#ffffff',
                            fontSize: 12,
                            rotate: 45
                        },
                        axisLine: {
                            lineStyle: { color: '#444' }
                        }
                    }
                ],
                yAxis: [
                    {
                        type: 'value',
                        gridIndex: 0,
                        min: 0,
                        max: 5,
                        axisLabel: {
                            color: '#ffffff',
                            fontSize: 12
                        },
                        axisLine: {
                            lineStyle: { color: '#444' }
                        },
                        splitLine: {
                            lineStyle: { color: '#333' }
                        }
                    },
                    {
                        type: 'value',
                        gridIndex: 1,
                        min: 0,
                        max: 5,
                        axisLabel: {
                            color: '#ffffff',
                            fontSize: 12
                        },
                        axisLine: {
                            lineStyle: { color: '#444' }
                        },
                        splitLine: {
                            lineStyle: { color: '#333' }
                        }
                    }
                ],
                series: [
                    // ç¬¬ä¸€æ’ - YOYO
                    {
                        name: 'YOYO',
                        type: 'bar',
                        xAxisIndex: 0,
                        yAxisIndex: 0,
                        data: firstRowData.map(item => item.YOYO),
                        itemStyle: {
                            color: '#00d4ff'
                        },
                        barWidth: '25%'
                    },
                    // ç¬¬ä¸€æ’ - è±†åŒ…
                    {
                        name: 'è±†åŒ…',
                        type: 'bar',
                        xAxisIndex: 0,
                        yAxisIndex: 0,
                        data: firstRowData.map(item => item.è±†åŒ…),
                        itemStyle: {
                            color: '#00ff88'
                        },
                        barWidth: '25%'
                    },
                    // ç¬¬ä¸€æ’ - å°å¤©
                    {
                        name: 'å°å¤©',
                        type: 'bar',
                        xAxisIndex: 0,
                        yAxisIndex: 0,
                        data: firstRowData.map(item => item.å°å¤©),
                        itemStyle: {
                            color: '#ff6b6b'
                        },
                        barWidth: '25%'
                    },
                    // ç¬¬äºŒæ’ - YOYO
                    {
                        name: 'YOYO',
                        type: 'bar',
                        xAxisIndex: 1,
                        yAxisIndex: 1,
                        data: secondRowData.map(item => item.YOYO),
                        itemStyle: {
                            color: '#00d4ff'
                        },
                        barWidth: '25%'
                    },
                    // ç¬¬äºŒæ’ - è±†åŒ…
                    {
                        name: 'è±†åŒ…',
                        type: 'bar',
                        xAxisIndex: 1,
                        yAxisIndex: 1,
                        data: secondRowData.map(item => item.è±†åŒ…),
                        itemStyle: {
                            color: '#00ff88'
                        },
                        barWidth: '25%'
                    },
                    // ç¬¬äºŒæ’ - å°å¤©
                    {
                        name: 'å°å¤©',
                        type: 'bar',
                        xAxisIndex: 1,
                        yAxisIndex: 1,
                        data: secondRowData.map(item => item.å°å¤©),
                        itemStyle: {
                            color: '#ff6b6b'
                        },
                        barWidth: '25%'
                    }
                ],
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                    borderColor: '#00d4ff',
                    textStyle: {
                        color: '#ffffff'
                    },
                    formatter: function(params) {
                        let result = params[0].name + '<br/>'
                        params.forEach(param => {
                            if (param.value !== undefined) {
                                result += param.seriesName + ': ' + param.value + 'åˆ†<br/>'
                            }
                        })
                        return result
                    }
                }
            };
            
            chart.setOption(option);
            
            // å“åº”å¼
            window.addEventListener('resize', function() {
                chart.resize();
            });
        }

        // åˆ›å»ºæ¨¡æ‹Ÿå›¾è¡¨
        function createMockChart() {
            const categories = [
                'æ•™è‚²', 'åŒ»ç–—å¥åº·', 'ç»æµé‡‘è', 'ç§‘æŠ€æŠ€æœ¯', 'æ³•å¾‹',
                'å¨±ä¹', 'ä½“è‚²è¿åŠ¨', 'æ—…æ¸¸', 'ç¾é£Ÿé¤é¥®', 'è´­ç‰©æ¶ˆè´¹',
                'äº¤é€šå‡ºè¡Œ', 'æˆ¿äº§ç½®ä¸š', 'å·¥ä½œèŒåœº', 'æƒ…æ„Ÿå…³ç³»', 'ç”Ÿæ´»æœåŠ¡', 'å…¶ä»–'
            ];
            
            const mockData = categories.map(category => ({
                category,
                YOYO: +(Math.random() * 1.5 + 3.5).toFixed(2), // 3.5-5.0
                è±†åŒ…: +(Math.random() * 1.2 + 3.2).toFixed(2), // 3.2-4.4
                å°å¤©: +(Math.random() * 1.0 + 3.0).toFixed(2)  // 3.0-4.0
            }));
            
            createChart(mockData);
        }

        // é¡µé¢åŠ è½½æ—¶æµ‹è¯•API
        testAPI();
    </script>
</body>
</html>
