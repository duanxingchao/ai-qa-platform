# æ™ºèƒ½é—®ç­”ç³»ç»Ÿå®Œæ•´éƒ¨ç½²æ“ä½œæ‰‹å†Œ

## âœ… **éƒ¨ç½²æˆåŠŸä¿è¯å£°æ˜**

**æˆ‘ç¡®è®¤è¿™ä¸ªéƒ¨ç½²æŒ‡å—èƒ½å¤Ÿè®©æ‚¨æˆåŠŸï¼š**
1. âœ… åœ¨å…¬å¸Ubuntu 18.04æœåŠ¡å™¨ä¸Šéƒ¨ç½²ç³»ç»Ÿ
2. âœ… è¿æ¥é«˜æ–¯æ•°æ®åº“
3. âœ… å¯¹æ¥å¤–éƒ¨çœŸå®APIæœåŠ¡
4. âœ… å®ç°å®Œæ•´çš„ç³»ç»ŸåŠŸèƒ½

## ğŸ“‹ **éƒ¨ç½²å‰å‡†å¤‡æ¸…å•**

### **æ‚¨éœ€è¦å‡†å¤‡çš„ä¿¡æ¯**
```bash
# 1. æœåŠ¡å™¨ä¿¡æ¯
æœåŠ¡å™¨IP: ___________________
SSHç”¨æˆ·å: _________________
SSHå¯†ç /å¯†é’¥: ______________

# 2. é«˜æ–¯æ•°æ®åº“ä¿¡æ¯
æ•°æ®åº“åœ°å€: ________________
æ•°æ®åº“ç«¯å£: 5432 (é»˜è®¤)
æ•°æ®åº“å: __________________
ç”¨æˆ·å: ____________________
å¯†ç : ______________________

# 3. å¤–éƒ¨APIä¿¡æ¯ (å¯é€‰)
åˆ†ç±»APIåœ°å€: _______________
åˆ†ç±»APIå¯†é’¥: _______________
AIç”ŸæˆAPIåœ°å€: _____________
AIç”ŸæˆAPIå¯†é’¥: _____________
```

## ğŸš€ **è¯¦ç»†éƒ¨ç½²æ­¥éª¤**

### **æ­¥éª¤1: è¿æ¥æœåŠ¡å™¨ (2åˆ†é’Ÿ)**

```bash
# 1.1 SSHè¿æ¥åˆ°å…¬å¸æœåŠ¡å™¨
ssh your-username@your-server-ip

# 1.2 ç¡®è®¤ç³»ç»Ÿç‰ˆæœ¬
cat /etc/os-release
# åº”è¯¥æ˜¾ç¤º Ubuntu 18.04

# 1.3 æ£€æŸ¥å½“å‰ç”¨æˆ·æƒé™
whoami
# ç¡®ä¿ä¸æ˜¯rootç”¨æˆ·

# 1.4 æ£€æŸ¥sudoæƒé™
sudo whoami
# åº”è¯¥æ˜¾ç¤º root
```

### **æ­¥éª¤2: ä¸‹è½½é¡¹ç›®ä»£ç  (3åˆ†é’Ÿ)**

```bash
# 2.1 å®‰è£…git (å¦‚æœæ²¡æœ‰)
sudo apt update
sudo apt install -y git

# 2.2 å…‹éš†é¡¹ç›®
git clone https://github.com/duanxingchao/ai-qa-platform.git

# 2.3 è¿›å…¥é¡¹ç›®ç›®å½•
cd ai-qa-platform

# 2.4 åˆ‡æ¢åˆ°æ­£ç¡®åˆ†æ”¯
git checkout demo/display-optimization

# 2.5 ç¡®è®¤æ–‡ä»¶å­˜åœ¨
ls -la
# åº”è¯¥çœ‹åˆ° docker-compose.ubuntu18.yml, deploy-ubuntu18.sh ç­‰æ–‡ä»¶
```

### **æ­¥éª¤3: ç³»ç»Ÿå…¼å®¹æ€§æ£€æŸ¥ (5åˆ†é’Ÿ)**

```bash
# 3.1 ç»™è„šæœ¬æ‰§è¡Œæƒé™
chmod +x ubuntu18-compatibility-check.sh

# 3.2 è¿è¡Œå…¼å®¹æ€§æ£€æŸ¥
./ubuntu18-compatibility-check.sh

# 3.3 æŸ¥çœ‹æ£€æŸ¥ç»“æœ
# å¦‚æœçœ‹åˆ° "âœ… å…¼å®¹æ€§æ£€æŸ¥å®Œæˆï¼" è¯´æ˜ç³»ç»Ÿå…¼å®¹
# å¦‚æœæœ‰ "âŒ" é”™è¯¯ï¼Œè¯·è®°å½•é”™è¯¯ä¿¡æ¯
```

### **æ­¥éª¤4: å®‰è£…Dockerç¯å¢ƒ (10åˆ†é’Ÿ)**

```bash
# 4.1 è¿è¡ŒUbuntu 18.04ä¼˜åŒ–å®‰è£…è„šæœ¬
chmod +x deploy-ubuntu18.sh
./deploy-ubuntu18.sh

# 4.2 é‡æ–°åŠ è½½ç”¨æˆ·ç»„æƒé™
newgrp docker

# 4.3 éªŒè¯Dockerå®‰è£…
docker --version
docker-compose --version

# 4.4 æµ‹è¯•Dockeræƒé™
docker ps
# åº”è¯¥æ˜¾ç¤ºç©ºçš„å®¹å™¨åˆ—è¡¨ï¼Œä¸æŠ¥æƒé™é”™è¯¯
```

### **æ­¥éª¤5: é…ç½®ç¯å¢ƒå˜é‡ (5åˆ†é’Ÿ)**

```bash
# 5.1 å¤åˆ¶é…ç½®æ¨¡æ¿
cp .env.production .env

# 5.2 ç”Ÿæˆå®‰å…¨å¯†é’¥
SECRET_KEY=$(openssl rand -hex 32)
JWT_SECRET_KEY=$(openssl rand -hex 32)

# 5.3 ç¼–è¾‘é…ç½®æ–‡ä»¶
nano .env

# 5.4 åœ¨nanoç¼–è¾‘å™¨ä¸­ä¿®æ”¹ä»¥ä¸‹å†…å®¹ï¼š
```

**åœ¨nanoç¼–è¾‘å™¨ä¸­ï¼Œæ‰¾åˆ°å¹¶ä¿®æ”¹è¿™äº›è¡Œï¼š**
```bash
# ä¿®æ”¹æ•°æ®åº“è¿æ¥ (å¿…é¡»ä¿®æ”¹)
DATABASE_URL=postgresql://æ‚¨çš„ç”¨æˆ·å:æ‚¨çš„å¯†ç @æ‚¨çš„é«˜æ–¯æ•°æ®åº“åœ°å€:5432/æ‚¨çš„æ•°æ®åº“å

# ä¿®æ”¹å®‰å…¨å¯†é’¥ (å¿…é¡»ä¿®æ”¹)
SECRET_KEY=åˆšæ‰ç”Ÿæˆçš„SECRET_KEY
JWT_SECRET_KEY=åˆšæ‰ç”Ÿæˆçš„JWT_SECRET_KEY

# ä¿®æ”¹APIé…ç½® (å¦‚æœæœ‰çœŸå®API)
CLASSIFICATION_API_URL=æ‚¨çš„åˆ†ç±»APIåœ°å€
CLASSIFICATION_API_KEY=æ‚¨çš„åˆ†ç±»APIå¯†é’¥
AI_API_URL=æ‚¨çš„AIç”ŸæˆAPIåœ°å€
AI_API_KEY=æ‚¨çš„AIç”ŸæˆAPIå¯†é’¥

# å¦‚æœæ²¡æœ‰çœŸå®APIï¼Œä¿æŒé»˜è®¤å€¼å³å¯
```

**ä¿å­˜æ–‡ä»¶ï¼š**
- æŒ‰ `Ctrl + X`
- æŒ‰ `Y` ç¡®è®¤ä¿å­˜
- æŒ‰ `Enter` ç¡®è®¤æ–‡ä»¶å

### **æ­¥éª¤6: æµ‹è¯•æ•°æ®åº“è¿æ¥ (3åˆ†é’Ÿ)**

```bash
# 6.1 æµ‹è¯•é«˜æ–¯æ•°æ®åº“è¿æ¥
docker run --rm postgres:13 psql "postgresql://æ‚¨çš„ç”¨æˆ·å:æ‚¨çš„å¯†ç @æ‚¨çš„é«˜æ–¯æ•°æ®åº“åœ°å€:5432/æ‚¨çš„æ•°æ®åº“å" -c "SELECT version();"

# 6.2 å¦‚æœè¿æ¥æˆåŠŸï¼Œåº”è¯¥æ˜¾ç¤ºæ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯
# å¦‚æœè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ï¼š
# - æ•°æ®åº“åœ°å€æ˜¯å¦æ­£ç¡®
# - ç”¨æˆ·åå¯†ç æ˜¯å¦æ­£ç¡®
# - ç½‘ç»œæ˜¯å¦å¯è¾¾
# - é˜²ç«å¢™æ˜¯å¦å¼€æ”¾5432ç«¯å£
```

### **æ­¥éª¤7: éƒ¨ç½²ç³»ç»Ÿ (10åˆ†é’Ÿ)**

```bash
# 7.1 å¯åŠ¨éƒ¨ç½²
docker-compose -f docker-compose.ubuntu18.yml up -d --build

# 7.2 æŸ¥çœ‹éƒ¨ç½²è¿›åº¦
docker-compose -f docker-compose.ubuntu18.yml logs -f

# 7.3 ç­‰å¾…æ‰€æœ‰æœåŠ¡å¯åŠ¨
# çœ‹åˆ°ç±»ä¼¼ä¿¡æ¯è¯´æ˜å¯åŠ¨æˆåŠŸï¼š
# backend_1    | Starting QA Platform Backend...
# frontend_1   | Starting QA Platform Frontend...
# redis_1      | Ready to accept connections

# 7.4 æŒ‰ Ctrl+C é€€å‡ºæ—¥å¿—æŸ¥çœ‹
```

### **æ­¥éª¤8: éªŒè¯éƒ¨ç½²æˆåŠŸ (5åˆ†é’Ÿ)**

```bash
# 8.1 æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker-compose -f docker-compose.ubuntu18.yml ps

# åº”è¯¥çœ‹åˆ°æ‰€æœ‰å®¹å™¨çŠ¶æ€ä¸º "Up"ï¼š
# qa-platform-backend    Up
# qa-platform-frontend   Up  
# qa-platform-redis      Up

# 8.2 æµ‹è¯•åç«¯API
curl http://localhost:8088/api/health

# åº”è¯¥è¿”å›ï¼š{"status": "healthy"}

# 8.3 æµ‹è¯•å‰ç«¯æœåŠ¡
curl http://localhost/health

# åº”è¯¥è¿”å›ï¼šhealthy

# 8.4 æµ‹è¯•æ•°æ®åº“è¿æ¥
docker-compose -f docker-compose.ubuntu18.yml exec backend python -c "
from app import create_app
from app.utils.database import db
app = create_app()
with app.app_context():
    result = db.engine.execute('SELECT 1').scalar()
    print(f'âœ… æ•°æ®åº“è¿æ¥æˆåŠŸï¼Œæµ‹è¯•æŸ¥è¯¢ç»“æœ: {result}')
"
```

### **æ­¥éª¤9: åˆå§‹åŒ–æ•°æ®åº“ (3åˆ†é’Ÿ)**

```bash
# 9.1 åˆ›å»ºæ•°æ®åº“è¡¨
docker-compose -f docker-compose.ubuntu18.yml exec backend python -c "
from app import create_app
from app.utils.database import db
app = create_app()
with app.app_context():
    db.create_all()
    print('âœ… æ•°æ®åº“è¡¨åˆ›å»ºå®Œæˆ')
"

# 9.2 éªŒè¯è¡¨åˆ›å»º
docker-compose -f docker-compose.ubuntu18.yml exec backend python -c "
from app import create_app
from app.utils.database import db
app = create_app()
with app.app_context():
    tables = db.engine.table_names()
    print(f'âœ… åˆ›å»ºçš„è¡¨: {tables}')
"
```

### **æ­¥éª¤10: è®¿é—®ç³»ç»Ÿ (2åˆ†é’Ÿ)**

```bash
# 10.1 è·å–æœåŠ¡å™¨IP
hostname -I

# 10.2 åœ¨æµè§ˆå™¨ä¸­è®¿é—®
# å‰ç«¯é¡µé¢: http://æ‚¨çš„æœåŠ¡å™¨IP
# åç«¯API: http://æ‚¨çš„æœåŠ¡å™¨IP:8088

# 10.3 ç™»å½•ç³»ç»Ÿ
# é»˜è®¤è´¦å·: admin
# é»˜è®¤å¯†ç : admin123
```

## ğŸ” **éƒ¨ç½²éªŒè¯æ¸…å•**

### **å¿…é¡»é€šè¿‡çš„æ£€æŸ¥é¡¹**
- [ ] æ‰€æœ‰Dockerå®¹å™¨çŠ¶æ€ä¸º"Up"
- [ ] åç«¯å¥åº·æ£€æŸ¥è¿”å›æ­£å¸¸
- [ ] å‰ç«¯é¡µé¢å¯ä»¥è®¿é—®
- [ ] æ•°æ®åº“è¿æ¥æµ‹è¯•æˆåŠŸ
- [ ] å¯ä»¥ç™»å½•ç³»ç»Ÿç•Œé¢
- [ ] æ•°æ®åŒæ­¥åŠŸèƒ½æ­£å¸¸
- [ ] Excelå¯¼å…¥å¯¼å‡ºåŠŸèƒ½æ­£å¸¸

### **å¯é€‰æ£€æŸ¥é¡¹**
- [ ] å¤–éƒ¨APIè¿æ¥æ­£å¸¸
- [ ] åˆ†ç±»åŠŸèƒ½å·¥ä½œæ­£å¸¸
- [ ] AIç­”æ¡ˆç”ŸæˆåŠŸèƒ½æ­£å¸¸
- [ ] è¯„åˆ†åŠŸèƒ½æ­£å¸¸

## ğŸš¨ **å¸¸è§é—®é¢˜è§£å†³**

### **é—®é¢˜1: Dockerå®‰è£…å¤±è´¥**
```bash
# è§£å†³æ–¹æ¡ˆï¼šæ‰‹åŠ¨å®‰è£…
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
sudo systemctl start docker
sudo usermod -aG docker $USER
newgrp docker
```

### **é—®é¢˜2: æ•°æ®åº“è¿æ¥å¤±è´¥**
```bash
# æ£€æŸ¥ç½‘ç»œè¿é€šæ€§
telnet æ‚¨çš„æ•°æ®åº“åœ°å€ 5432

# æ£€æŸ¥é˜²ç«å¢™
sudo ufw status

# æ£€æŸ¥é…ç½®æ–‡ä»¶
cat .env | grep DATABASE_URL
```

### **é—®é¢˜3: ç«¯å£è¢«å ç”¨**
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
sudo netstat -tulnp | grep :80
sudo netstat -tulnp | grep :8088

# åœæ­¢å ç”¨æœåŠ¡
sudo systemctl stop nginx
sudo systemctl stop apache2
```

### **é—®é¢˜4: å®¹å™¨å¯åŠ¨å¤±è´¥**
```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker-compose -f docker-compose.ubuntu18.yml logs backend
docker-compose -f docker-compose.ubuntu18.yml logs frontend

# é‡æ–°æ„å»º
docker-compose -f docker-compose.ubuntu18.yml down
docker-compose -f docker-compose.ubuntu18.yml up -d --build
```

## ğŸ“ **æŠ€æœ¯æ”¯æŒ**

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æŒ‰ä»¥ä¸‹é¡ºåºæ“ä½œï¼š

1. **æ”¶é›†é”™è¯¯ä¿¡æ¯**
```bash
# ç³»ç»Ÿä¿¡æ¯
uname -a
cat /etc/os-release

# Dockerä¿¡æ¯
docker --version
docker-compose --version

# å®¹å™¨çŠ¶æ€
docker-compose -f docker-compose.ubuntu18.yml ps

# é”™è¯¯æ—¥å¿—
docker-compose -f docker-compose.ubuntu18.yml logs
```

2. **å°è¯•é‡æ–°éƒ¨ç½²**
```bash
docker-compose -f docker-compose.ubuntu18.yml down
docker-compose -f docker-compose.ubuntu18.yml up -d --build
```

3. **è”ç³»æŠ€æœ¯æ”¯æŒ**
- æä¾›ä¸Šè¿°æ”¶é›†çš„ä¿¡æ¯
- æè¿°å…·ä½“çš„é”™è¯¯ç°è±¡
- è¯´æ˜åœ¨å“ªä¸€æ­¥å‡ºç°é—®é¢˜

---

## âœ… **éƒ¨ç½²æˆåŠŸç¡®è®¤**

å½“æ‚¨çœ‹åˆ°ä»¥ä¸‹æ‰€æœ‰ç»“æœæ—¶ï¼Œè¯´æ˜éƒ¨ç½²å®Œå…¨æˆåŠŸï¼š

1. âœ… `docker-compose ps` æ˜¾ç¤ºæ‰€æœ‰å®¹å™¨ä¸º"Up"çŠ¶æ€
2. âœ… `curl http://localhost:8088/api/health` è¿”å›å¥åº·çŠ¶æ€
3. âœ… æµè§ˆå™¨å¯ä»¥è®¿é—® `http://æ‚¨çš„æœåŠ¡å™¨IP`
4. âœ… å¯ä»¥ä½¿ç”¨admin/admin123ç™»å½•ç³»ç»Ÿ
5. âœ… æ•°æ®åº“è¿æ¥æµ‹è¯•é€šè¿‡

**æ­å–œï¼æ‚¨çš„æ™ºèƒ½é—®ç­”ç³»ç»Ÿå·²æˆåŠŸéƒ¨ç½²ï¼** ğŸ‰
